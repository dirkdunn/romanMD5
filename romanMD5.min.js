function rot13(r){if("string"==typeof r){var n=["A","a","B","b","C","c","D","d","E","e","F","f","G","g","H","h","I","i","J","j","K","k","L","l","M","m","N","n","O","o","P","p","Q","q","R","r","S","s","T","t","U","u","V","v","W","w","X","x","Y","y","Z","z"],t=r.trim().split("");for(var o in r)-1!==n.indexOf(r[o])&&(t[o]=n.indexOf(r[o])+26<n.length?n[n.indexOf(r[o])+26]:n[n.indexOf(r[o])-26]);return t.join("")}console.error("Wrong parameter type, must be type String.")}function encrypt(r,n){for(var t=n?!0:!1,n=n?n:Math.floor(900*Math.random()+100),o=0;n>o;o++)r=MD5(r),r=rot13(r);return t?r:[r,n]}var MD5=function(r){function n(r,n){return r<<n|r>>>32-n}function t(r,n){var t,o,e,f,u;return e=2147483648&r,f=2147483648&n,t=1073741824&r,o=1073741824&n,u=(1073741823&r)+(1073741823&n),t&o?2147483648^u^e^f:t|o?1073741824&u?3221225472^u^e^f:1073741824^u^e^f:u^e^f}function o(r,n,t){return r&n|~r&t}function e(r,n,t){return r&t|n&~t}function f(r,n,t){return r^n^t}function u(r,n,t){return n^(r|~t)}function i(r,e,f,u,i,a,c){return r=t(r,t(t(o(e,f,u),i),c)),t(n(r,a),e)}function a(r,o,f,u,i,a,c){return r=t(r,t(t(e(o,f,u),i),c)),t(n(r,a),o)}function c(r,o,e,u,i,a,c){return r=t(r,t(t(f(o,e,u),i),c)),t(n(r,a),o)}function g(r,o,e,f,i,a,c){return r=t(r,t(t(u(o,e,f),i),c)),t(n(r,a),o)}function h(r){for(var n,t=r.length,o=t+8,e=(o-o%64)/64,f=16*(e+1),u=Array(f-1),i=0,a=0;t>a;)n=(a-a%4)/4,i=a%4*8,u[n]=u[n]|r.charCodeAt(a)<<i,a++;return n=(a-a%4)/4,i=a%4*8,u[n]=u[n]|128<<i,u[f-2]=t<<3,u[f-1]=t>>>29,u}function C(r){var n,t,o="",e="";for(t=0;3>=t;t++)n=r>>>8*t&255,e="0"+n.toString(16),o+=e.substr(e.length-2,2);return o}function d(r){r=r.replace(/\r\n/g,"\n");for(var n="",t=0;t<r.length;t++){var o=r.charCodeAt(t);128>o?n+=String.fromCharCode(o):o>127&&2048>o?(n+=String.fromCharCode(o>>6|192),n+=String.fromCharCode(63&o|128)):(n+=String.fromCharCode(o>>12|224),n+=String.fromCharCode(o>>6&63|128),n+=String.fromCharCode(63&o|128))}return n}var m,v,l,p,s,S,y,x,A,M=Array(),O=7,b=12,D=17,j=22,w=5,L=9,W=14,k=20,q=4,z=11,B=16,E=23,F=6,G=10,H=15,I=21;for(r=d(r),M=h(r),S=1732584193,y=4023233417,x=2562383102,A=271733878,m=0;m<M.length;m+=16)v=S,l=y,p=x,s=A,S=i(S,y,x,A,M[m+0],O,3614090360),A=i(A,S,y,x,M[m+1],b,3905402710),x=i(x,A,S,y,M[m+2],D,606105819),y=i(y,x,A,S,M[m+3],j,3250441966),S=i(S,y,x,A,M[m+4],O,4118548399),A=i(A,S,y,x,M[m+5],b,1200080426),x=i(x,A,S,y,M[m+6],D,2821735955),y=i(y,x,A,S,M[m+7],j,4249261313),S=i(S,y,x,A,M[m+8],O,1770035416),A=i(A,S,y,x,M[m+9],b,2336552879),x=i(x,A,S,y,M[m+10],D,4294925233),y=i(y,x,A,S,M[m+11],j,2304563134),S=i(S,y,x,A,M[m+12],O,1804603682),A=i(A,S,y,x,M[m+13],b,4254626195),x=i(x,A,S,y,M[m+14],D,2792965006),y=i(y,x,A,S,M[m+15],j,1236535329),S=a(S,y,x,A,M[m+1],w,4129170786),A=a(A,S,y,x,M[m+6],L,3225465664),x=a(x,A,S,y,M[m+11],W,643717713),y=a(y,x,A,S,M[m+0],k,3921069994),S=a(S,y,x,A,M[m+5],w,3593408605),A=a(A,S,y,x,M[m+10],L,38016083),x=a(x,A,S,y,M[m+15],W,3634488961),y=a(y,x,A,S,M[m+4],k,3889429448),S=a(S,y,x,A,M[m+9],w,568446438),A=a(A,S,y,x,M[m+14],L,3275163606),x=a(x,A,S,y,M[m+3],W,4107603335),y=a(y,x,A,S,M[m+8],k,1163531501),S=a(S,y,x,A,M[m+13],w,2850285829),A=a(A,S,y,x,M[m+2],L,4243563512),x=a(x,A,S,y,M[m+7],W,1735328473),y=a(y,x,A,S,M[m+12],k,2368359562),S=c(S,y,x,A,M[m+5],q,4294588738),A=c(A,S,y,x,M[m+8],z,2272392833),x=c(x,A,S,y,M[m+11],B,1839030562),y=c(y,x,A,S,M[m+14],E,4259657740),S=c(S,y,x,A,M[m+1],q,2763975236),A=c(A,S,y,x,M[m+4],z,1272893353),x=c(x,A,S,y,M[m+7],B,4139469664),y=c(y,x,A,S,M[m+10],E,3200236656),S=c(S,y,x,A,M[m+13],q,681279174),A=c(A,S,y,x,M[m+0],z,3936430074),x=c(x,A,S,y,M[m+3],B,3572445317),y=c(y,x,A,S,M[m+6],E,76029189),S=c(S,y,x,A,M[m+9],q,3654602809),A=c(A,S,y,x,M[m+12],z,3873151461),x=c(x,A,S,y,M[m+15],B,530742520),y=c(y,x,A,S,M[m+2],E,3299628645),S=g(S,y,x,A,M[m+0],F,4096336452),A=g(A,S,y,x,M[m+7],G,1126891415),x=g(x,A,S,y,M[m+14],H,2878612391),y=g(y,x,A,S,M[m+5],I,4237533241),S=g(S,y,x,A,M[m+12],F,1700485571),A=g(A,S,y,x,M[m+3],G,2399980690),x=g(x,A,S,y,M[m+10],H,4293915773),y=g(y,x,A,S,M[m+1],I,2240044497),S=g(S,y,x,A,M[m+8],F,1873313359),A=g(A,S,y,x,M[m+15],G,4264355552),x=g(x,A,S,y,M[m+6],H,2734768916),y=g(y,x,A,S,M[m+13],I,1309151649),S=g(S,y,x,A,M[m+4],F,4149444226),A=g(A,S,y,x,M[m+11],G,3174756917),x=g(x,A,S,y,M[m+2],H,718787259),y=g(y,x,A,S,M[m+9],I,3951481745),S=t(S,v),y=t(y,l),x=t(x,p),A=t(A,s);var J=C(S)+C(y)+C(x)+C(A);return J.toLowerCase()};module.exports=encrypt;